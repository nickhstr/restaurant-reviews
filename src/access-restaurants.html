<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<link rel="import" href="access-restaurant.html">
<link rel="import" href="access-menu.html">

<dom-module id="access-restaurants">
	<template>
		<style>
			div.resties {
				padding: 15px;
			}

			p {
				margin: 0;
			}
		</style>

		<div class="resties">
			<div>
				<button on-tap="setSort" value="az">Sort A-Z</button>
				<button on-tap="setSort" value="za">Sort Z-A</button>
				<button on-tap="setFilter">Filter</button>
				<button on-tap="reset">Reset</button>
			</div>
			<template is="dom-repeat" items="[[queryData]]" as="restaurant" sort="[[sort]]" filter="[[filter]]">
				<access-restaurant
					name="[[restaurant.name]]"
					address="[[restaurant.address]]"
					stars="[[restaurant.stars]]"
					rest-id="[[restaurant.$key]]"
					reviews="[[restaurant.reviews]]"></access-restaurant>
			</template>
		</div>
	</template>
	<script>
		
	Polymer({

		is: 'access-restaurants',

		properties: {
			sort: {
				type: Function,
				notify: true
			},
			filter: {
				type: Function,
				notify: true
			},
			sortOptions: {
				type: Array,
				value: ['one', 'two', 'three'],
				notify: true
			}
		},

		sortName: function(val) {
			return function(a, b) {
				var nameA = a.name.toUpperCase();
				var nameB = b.name.toUpperCase();
				if (nameA < nameB) {
					return -val;
				}
				if (nameA > nameB) {
					return val;
				}
				return 0;
			};
		},

		setSort: function(e) {
			var val = e.target.value;
			if (val === 'az') {
				this.sort = this.sortName(1);
			}
			else if (val === 'za') {
				this.sort = this.sortName(-1);
			}
		},

		setFilter: function() {
			this.filter = function(item) {
				return item.stars >= 4;
			}
		},

		reset: function() {
			this.sort = null;
			this.filter = null;
		}

	});

	</script>
</dom-module>