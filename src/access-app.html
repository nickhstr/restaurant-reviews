<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/polymerfire/polymerfire.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="access-home.html">
<link rel="import" href="access-restaurants.html">
<link rel="import" href="access-reviews.html">

<dom-module id="access-app">
	<template>
		<style>
			:host {
				--primary-theme-color: blue;
				--secondary-theme-color: red;
				--primary-padding: 20px;
			}

			app-toolbar {
				background-color: #faa;
			}

			.logo a {
				pointer-events: auto;
			}

			.test {
				min-height: 500px;
				background-color: #aaccff;
				padding: var(--primary-padding);
			}

			p {
				margin: 0;
			}

			footer {
				height: 700px;
			}
		</style>

		<firebase-document
		id="fd"
		app-name="restaurants"
		path="{{docPath}}"
		data="{{docData}}"></firebase-document>

		<app-location route="{{route}}"></app-location>

		<app-route
			id="mainRoute"
			route="{{route}}"
			pattern="/:page"
			data="{{routeData}}"
			tail="{{subroute}}">
		</app-route>

		<app-route
			id="secondRoute"
			route="{{subroute}}"
			pattern="/:restaurant"
			data="{{secondRouteData}}">
		</app-route>

		<app-header-layout>
			<app-header role="navigation" reveals effects="waterfall">
				<app-toolbar>
					<div class="logo" main-title><a href="/" aria-label="Food for Thought Home">Food for Thought</a></div>
					<a href="/restaurants">Restaurants</a>
				</app-toolbar>
			</app-header>

			<iron-pages role="main" selected="[[page]]" attr-for-selected="name">
				<access-home name="home"></access-home>
				<!-- <button on-tap="addRest">Add</button> -->
				<access-restaurants name="restaurants"></access-restaurants>
				<access-reviews name="reviews" rest-id="[[restId]]"></access-reviews>
			</iron-pages>

			<footer>El Footer</footer>
		</app-header-layout>
	</template>
	<script>
		
	Polymer({

		is: 'access-app',

		properties: {
			restId: {
				type: String,
				value: '',
				notify: true
			}
		},

		observers: [
			'_routePathChanged(routeData.page)'
		],

		listeners: {
			'newId': 'updateId'
		},

		_routePathChanged: function(page) {
			this.page = page || 'home';
		},

		updateId: function(e) {
			this.restId = e.detail.id;
			this.reviews = e.detail.reviews;
		},

		addRest: function() {
			this.docData = {
				name: 'Skeeter\'s Grill',
				address: '555 Main St. USA',
				photo: 'https://upload.wikimedia.org/wikipedia/commons/1/1f/Silver_Diner_Interior_View.jpg',
				hours: '9am - 9pm'
			};
			this.$.fd.save('/restaurants');
			this.$.fd.path = null;
		},

		restFilter: function(item) {
			return item.address == '555 Main St. USA';
		}

	})

	</script>
</dom-module>